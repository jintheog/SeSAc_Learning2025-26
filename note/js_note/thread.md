# Thread

- 프로그램의 작업을 처리 하는 단위
- JS는 싱글 쓰레드 이다. JS는 한번에 하나의 작업만 처리 할 수 있다.

# 동기적 처리 synchronous

- 하나의 작업이 끝날 떄 가지 다음 작업을 시작하지 않는 방식
- 순차적 처리
- 앞의 작업이 길어지면 전체 프로그램 정지
- 시작과 끝이 같음.

# 비동기적 처리

- 시간이 오래 걸리는 작업을 백그라운드에서 처리하며 다른 작업을 계속 진행 하는 방식
- 동시 처리
- 프로그램 정지 없음

# 블록킹(Blocking)과 논블록킹(Non-Blocking)

- 블록킹: 하나의 작업이 끝날 때까지 다음 작업을 시작하지 않는 방식, 동기적 처리
- 논블록킹: 하나의 작업이 끝날 때까지 기다리지 않고 다음 작업을 시작하는 방식, 비동기적 처리

# JS 비동기 처리 API

- 웹 프라우저(node.js) 제공 비동기 처리 함수
- 비동기 처리 API는 콜백 함수를 필수 인자로 받음

# 비동기 처리 예시

#### 네이버 타이머

- 타이머: 대표적인 비동기 처리 활용 기능
- 타이머 시작 후, 시간의 흐름과 다른 기능 동시 사용 가능
  즉, 시간 흐름 기능은 비동기 처리, 다른 기능은 동시 작동

# JS는 싱글 스레드 환경

# 웹브라우저(node.js)는 멀티 스레드 환경

# JavaScript 비동기 처리 구성 요소와 메커니즘

## Web APIs

- 웹 브라우저 또는 Node.js 환경이 제공하는 비동기 기능(setTimeout, fetch 등) 처리
- JavaScript 코드 실행 환경과 분리된 멀티 스레드 환경

## 콜백 큐 (Callback Queue Task Queue)

- 비동기 처리 완료 후 실행될 콜백 함수 대기 장소

## 이벤트 루프 (Event Loop)

- 콜 스택의 상태를 지속적으로 확인하여, 비어있을 경우 콜백 큐의 함수를 콜 스택으로 이동

## 콜 스택 (Call Stack)

- 현재 실행 중인 함수가 쌓이는 곳
- JavaScript 코드 실행 영역
- 싱글 스레드 환경

---

### **JS 코드 실행**:

- 먼저 JS 코드 (실행 컨텍스트: 자바스크립트 코드가 실행될 때 필요한 환경 정보 묶음.)가 콜 스택에 쌓이고 순차적으로 실행됨

---

### **비동기 작업 호출**:

- JS엔진이 콜 스택에서 동작하는 실행 컨텍스트를 한줄씩 읽다가 실행 도중에 `setTimeout`, `fetch`, `addEvenListener` 과 같은 비동기 함수를 만나면, 함수는 즉시 실행되지만, 내부 동작(타이머, 네트워크, 이벤트 감시 등)은 JS 엔진이 처리하지 않고 Web API에게 위임.

---

### **Web API가 백그라운드에서 작업 진행**

- WebAPI가 타이머나 다른 작업을 백그라운드에서 처리한다.
- 어떤 함수냐에 따라 다른 일을 함:

  - setTimeout → 타이머 카운트다운
  - fetch → HTTP 요청 전송 (응답 대기)
  - addEventListener → 클릭/입력 같은 이벤트 감지
  - requestAnimationFrame → 화면 리프레시 타이밍 대기

- JS 엔진은 이 작업을 기다리지 않고 바로 다음 코드 실행.
- Web API가 실행하는 건 **비동기 작업 그 자체(타이머, 네트워크, 이벤트 감지)**
- 백그라운드 작업이 완료되거나 조건이 충족되면, “이 콜백 실행 준비 끝났음” 하고 콜백을 **콜백 큐(Task Queue: 실행 준비가 끝난 콜백 함수들이 줄 서 있는 대기열)**에 넣음.

---

- 이벤트 루프가 콜 스택이 비었는지 확인.

- 비어 있다면 콜백 큐(Task Queue)에 함수가 있는지 확인. 콜백 큐의 맨 앞에 있는 콜백 함수 객체를 하나 꺼냄.

- 이벤트 루프는 해당 콜백 함수를 콜 스택으로 옮겨 실행 한다.

### **콜백 함수 실행**: 콜 스택에 올라온 콜백 함수가 실행된다.

- 방금 올려진 콜백 함수 객체가 실행 컨텍스트로 바뀌고,

- 이제야 JS 엔진이 그 콜백 코드를 실행함.

---

### 이벤트 루프가 감시하다가, 콜 스택이 비면 콜백 큐에서 콜백 함수 객체를 꺼내 콜 스택으로 옮기고, 그제야 JS 엔진이 해당 콜백을 실행한다.
